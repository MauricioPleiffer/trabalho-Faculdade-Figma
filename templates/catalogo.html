<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='catalogo.css')}}">
    <!-- <link rel="stylesheet" href="../static/styles.css"> -->
    <title>Lave já - Catálogo</title>
</head>
<body>
    <header>    
        <div class="header">
            <div class="logo">
                <img src="../static/imagem/lave.ja.png">
            </div>
            <div>
                <a href="{{ url_for('index')}}" class="botao-catalogo">INICIO</a>
                <a href="{{ url_for('carrinho_page')}}" class="botao-catalogo">CARRINHO <span id="cartCount" class="cart-count">0</span></a>
            </div>
        </div>
    </header>
    <main>
        <section class="servicos1">
            <div class="main-title">
                <h1>Nossos Planos</h1>
            </div>
            <div class="servicos">
                <div class="servico">
                   <h3>Lavar e Secar</h3>
                   <img src="/static/imagem/catalogo1.jpg" alt="Lavagem de roupas">
                   <p>Lavagem completa com secagem rapida, para roupas do dia a dia</p>
                   <p class="preco">R$ 28,00</p>
                   <a href="#" class="botao" onclick="addToCartAndGo(1)">Solicitar</a>
                </div>
                <div class="servico">
                   <h3>Lavar a Seco</h3>
                   <img src="/static/imagem/catalogo2.jpg" alt="Lavagem de roupas">
                   <p>Ideal para roupas que precisam de um cuidado especial sem água</p>
                   <p class="preco">R$ 44,00</p>
                   <a href="#" class="botao" onclick="addToCartAndGo(2)">Solicitar</a> 
                </div>
                <div class="servico">
                   <h3>Roupas Delicadas</h3>
                   <img src="/static/imagem/catalogo3.jpg" alt="Lavagem de roupas">
                   <p>Serviço especializado para roupas finas e delicadas</p>
                   <p class="preco">R$ 50,00</p>
                   <a href="#" class="botao" onclick="addToCartAndGo(3)">Solicitar</a> 
                </div>
            </div>
                <div class="main-title">
                    <h1>Lavagem por Quilo</h1>
                </div>
            <div class="servicos">
                <div class="servico">
                   <h3>10 kg</h3>
                   <img src="/static/imagem/catalogo4.jpg" alt="Lavagem de roupas">
                   <p>Lavagem até 10kg</p>
                   <p class="preco">R$ 65,00</p>
                   <a href="#" class="botao" onclick="addToCartAndGo(4)">Solicitar</a> 
                </div>
                <div class="servico">
                   <h3>20kg</h3>
                   <img src="/static/imagem/catalogo5.jpg" alt="Lavagem de roupas">
                   <p>Lavagem até 20kg</p>
                   <p class="preco">R$ 129,00</p>
                   <a href="#" class="botao" onclick="addToCartAndGo(5)">Solicitar</a> 
                </div>
                <div class="servico">
                   <h3>30kg</h3>
                   <img src="/static/imagem/catalogo6.jpg" alt="Lavagem de roupas">
                   <p>Lavagem até 30kg</p>
                   <p class="preco">R$ 195,00</p>
                   <a href="#" class="botao" onclick="addToCartAndGo(6)">Solicitar</a> 
                </div>
            </div>
        </section>         
    </main>
    <footer class="footer-bottom">
        <div id="footer-bottom">
            <p>© 2025 LaveJá - Lavanderia Profissional. Todos os direitos reservados.</p>
            <p>Desenvolvido com ❤️ para cuidar das suas roupas</p>
        </div>
        <div class="footer-completo"></div>
    </footer>
</body>
</html>

<script>
    // Envia o ID do serviço para o endpoint do blueprint de carrinho
    async function addToCartAndGo(servicoId) {
        try {
            const body = 'servico_id=' + encodeURIComponent(servicoId);
            const resp = await fetch('/auth/adicionar_ao_carrinho', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: body
            });
            const data = await resp.json();
                    if (resp.ok && data.sucesso) {
                        // Atualiza o contador no cabeçalho (se existir) e mostra confirmação
                        const countEl = document.getElementById('cartCount');
                        if (countEl && typeof data.count !== 'undefined') countEl.textContent = data.count;
                        alert((data.mensagem || 'Adicionado ao carrinho') + ': ' + data.nome + ' — R$ ' + Number(data.preco).toFixed(2));
                    } else {
                        alert('Erro ao adicionar ao carrinho: ' + (data.mensagem || 'Erro desconhecido'));
                    }
        } catch (err) {
            console.error(err);
            alert('Erro de conexão ao adicionar ao carrinho.');
        }
    }
</script>